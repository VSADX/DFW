function composeTemplateString(e,t){return e.reduce(((e,a,r)=>`${e}${String(t[r-1])}${a}`))}var _a,_IterableWeakMap_cleanup,_IterableWeakMap_weakMap,_IterableWeakMap_refSet,_IterableWeakMap_finalizationGroup,__classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};class IterableWeakMap{constructor(e=[]){_IterableWeakMap_weakMap.set(this,new WeakMap),_IterableWeakMap_refSet.set(this,new Set),_IterableWeakMap_finalizationGroup.set(this,new FinalizationRegistry(__classPrivateFieldGet(IterableWeakMap,_a,"f",_IterableWeakMap_cleanup)));for(const[t,a]of e)this.set(t,a)}set(e,t){const a=__classPrivateFieldGet(this,_IterableWeakMap_weakMap,"f").get(e);if(a)return void(a.value=t);const r=new WeakRef(e);__classPrivateFieldGet(this,_IterableWeakMap_weakMap,"f").set(e,{value:t,ref:r}),__classPrivateFieldGet(this,_IterableWeakMap_refSet,"f").add(r),__classPrivateFieldGet(this,_IterableWeakMap_finalizationGroup,"f").register(e,{set:__classPrivateFieldGet(this,_IterableWeakMap_refSet,"f"),ref:r},r)}get(e){return __classPrivateFieldGet(this,_IterableWeakMap_weakMap,"f").get(e)?.value}delete(e){const t=__classPrivateFieldGet(this,_IterableWeakMap_weakMap,"f").get(e);return!!t&&(__classPrivateFieldGet(this,_IterableWeakMap_weakMap,"f").delete(e),__classPrivateFieldGet(this,_IterableWeakMap_refSet,"f").delete(t.ref),__classPrivateFieldGet(this,_IterableWeakMap_finalizationGroup,"f").unregister(t.ref),!0)}has(e){return __classPrivateFieldGet(this,_IterableWeakMap_weakMap,"f").has(e)}forEach(e){for(const[t,a]of this)e(a,t,this)}clear(){for(const e of this.keys())this.delete(e)}emplace(e,t){const a=__classPrivateFieldGet(this,_IterableWeakMap_weakMap,"f").get(e);if(!a&&t.insert){const a=t.insert(e,this);return this.set(e,a),a}if(a&&t.update){const r=t.update(a.value,e,this);return this.set(e,r),r}return a?.value}get size(){let e=0;for(const t of __classPrivateFieldGet(this,_IterableWeakMap_refSet,"f"))t.deref()&&e++;return e}[(_IterableWeakMap_weakMap=new WeakMap,_IterableWeakMap_refSet=new WeakMap,_IterableWeakMap_finalizationGroup=new WeakMap,Symbol.hasInstance)](e){return e instanceof IterableWeakMap||e instanceof WeakMap}*[Symbol.iterator](){for(const e of this.keys()){const{value:t}=__classPrivateFieldGet(this,_IterableWeakMap_weakMap,"f").get(e);yield[e,t]}}entries(){return this[Symbol.iterator]()}*keys(){for(const e of __classPrivateFieldGet(this,_IterableWeakMap_refSet,"f")){const t=e.deref();t||console.log("key",t),t&&(yield t)}}*values(){for(const[,e]of this)yield e}}_a=IterableWeakMap,_IterableWeakMap_cleanup={value:({set:e,ref:t})=>{e.delete(t)}};var _a1,_WeakMultiRef_cleanup,_WeakMultiRef_finalizationGroup,__classPrivateFieldGet1=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};const refs=new Set;class WeakMultiRef{constructor(e){Object.defineProperty(this,"weakKeys",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),_WeakMultiRef_finalizationGroup.set(this,new FinalizationRegistry(__classPrivateFieldGet1(WeakMultiRef,_a1,"f",_WeakMultiRef_cleanup))),e.forEach((e=>{const t=new WeakRef(e);this.weakKeys.add(t),__classPrivateFieldGet1(this,_WeakMultiRef_finalizationGroup,"f").register(e,{set:this.weakKeys,ref:t,target:this},t)})),refs.add(this)}}function*concatIterators(...e){for(const t of e)yield*t}_a1=WeakMultiRef,_WeakMultiRef_finalizationGroup=new WeakMap,_WeakMultiRef_cleanup={value:({set:e,ref:t,target:a})=>{e.delete(t),e.size||refs.delete(a)}};class PassReactiveValue{constructor(e){Object.defineProperty(this,"deref",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.deref=e}}var _inner,_a2,__classPrivateFieldGet2=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};const internalSetReactiveValue=new(_a2=class{constructor(){_inner.set(this,new WeakMap)}get(e){return __classPrivateFieldGet2(this,_inner,"f").get(e)}set(e,t){__classPrivateFieldGet2(this,_inner,"f").set(e,t)}},_inner=new WeakMap,_a2),stronglyHeldDependencies=new Map,weaklyHeldDependencies=new IterableWeakMap;var __classPrivateFieldGet3=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)},__classPrivateFieldSet=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a};let computedConsumer;var _ReactiveValue_readonly,_ReadonlyReactiveValue_instances,_ReadonlyReactiveValue_value,_ReadonlyReactiveValue_callbacks,_ReadonlyReactiveValue_consumers,_ReadonlyReactiveValue_set,_ReadonlyReactiveValue_nextUpdate,__classPrivateFieldSet1=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a},__classPrivateFieldGet4=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};class ReadonlyReactiveValue1{constructor(e){_ReadonlyReactiveValue_instances.add(this),_ReadonlyReactiveValue_value.set(this,void 0),_ReadonlyReactiveValue_callbacks.set(this,new Set),_ReadonlyReactiveValue_consumers.set(this,new IterableWeakMap),Object.defineProperty(this,"dependencies",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),__classPrivateFieldSet(this,_ReadonlyReactiveValue_value,e,"f"),internalSetReactiveValue.set(this,((...e)=>__classPrivateFieldGet4(this,_ReadonlyReactiveValue_instances,"m",_ReadonlyReactiveValue_set).call(this,...e)))}valueOf(){return this.value}[(_ReadonlyReactiveValue_value=new WeakMap,_ReadonlyReactiveValue_callbacks=new WeakMap,_ReadonlyReactiveValue_consumers=new WeakMap,_ReadonlyReactiveValue_instances=new WeakSet,_ReadonlyReactiveValue_set=function(e,t){const{noUpdate:a,force:r}={noUpdate:[],force:!1,...t};if(r||!Object.is(e,__classPrivateFieldGet4(this,_ReadonlyReactiveValue_value,"f"))){__classPrivateFieldSet(this,_ReadonlyReactiveValue_value,e,"f");const t=concatIterators(__classPrivateFieldGet4(this,_ReadonlyReactiveValue_callbacks,"f").values(),__classPrivateFieldGet4(this,_ReadonlyReactiveValue_consumers,"f").values());for(const r of t)a.includes(r)||r(e)}return this},Symbol.toPrimitive)](){return this.value}toJSON(){return this.value}get[Symbol.toStringTag](){return`${this.constructor.name}<${typeof __classPrivateFieldGet4(this,_ReadonlyReactiveValue_value,"f")}>`}async*[Symbol.asyncIterator](){for(;;)yield await __classPrivateFieldGet4(this,_ReadonlyReactiveValue_instances,"m",_ReadonlyReactiveValue_nextUpdate).call(this)}bind(e,t={}){if(t.noFirstRun||e(this.value),t.dependents?.length){const a=new WeakMultiRef(t.dependents);__classPrivateFieldGet4(this,_ReadonlyReactiveValue_consumers,"f").set(a,e),weaklyHeldDependencies.set(a,this)}else __classPrivateFieldGet4(this,_ReadonlyReactiveValue_callbacks,"f").add(e),stronglyHeldDependencies.set(e,this);return this}unbind(e){return __classPrivateFieldGet4(this,_ReadonlyReactiveValue_callbacks,"f").delete(e),stronglyHeldDependencies.delete(e),this}get value(){if(computedConsumer){const{fn:e,consumer:t}=computedConsumer;t.dependencies.set(this,e),__classPrivateFieldGet4(this,_ReadonlyReactiveValue_consumers,"f").set(t,e)}return __classPrivateFieldGet4(this,_ReadonlyReactiveValue_value,"f")}pipe(e){const t=new ReadonlyReactiveValue1(e(__classPrivateFieldGet4(this,_ReadonlyReactiveValue_value,"f"))),a=()=>internalSetReactiveValue.get(t)(e(__classPrivateFieldGet4(this,_ReadonlyReactiveValue_value,"f")));return t.dependencies.set(this,a),__classPrivateFieldGet4(this,_ReadonlyReactiveValue_consumers,"f").set(t,a),t}truthy(e,t){return this.pipe((a=>a?e:t))}falsy(e,t){return this.pipe((a=>a?t:e))}get pass(){return new PassReactiveValue(this)}}class ReactiveValue1 extends ReadonlyReactiveValue1{constructor(){super(...arguments),_ReactiveValue_readonly.set(this,void 0)}update(){return this.set(this.value,{force:!0}),this}set(e,t){return internalSetReactiveValue.get(this)(e,t),this}get value(){return super.value}set value(e){this.set(e)}get readonly(){return __classPrivateFieldGet3(this,_ReactiveValue_readonly,"f")??__classPrivateFieldSet1(this,_ReactiveValue_readonly,this.pipe((e=>e)),"f")}}_ReactiveValue_readonly=new WeakMap,_ReadonlyReactiveValue_nextUpdate=function(){return new Promise((e=>{const t=a=>{e(a),__classPrivateFieldGet4(this,_ReadonlyReactiveValue_callbacks,"f").delete(t)};__classPrivateFieldGet4(this,_ReadonlyReactiveValue_callbacks,"f").add(t)}))};const hold=new WeakMap;function computed1(e,...t){if("raw"in e)return computed1((()=>composeTemplateString(e,t)));const a=e,r=new ReactiveValue1(void 0);function s(){computedConsumer={fn:s,consumer:r};const e=a();computedConsumer=void 0,r.value=e}return s(),hold.set(r,s),r.readonly}function throwExpression(e,t=Error){throw new t(e)}const deferredElements=new Map,nonRenderedValues=new Set([void 0,null,!0,!1]),shouldBeRendered=e=>!nonRenderedValues.has(e),stringifyValue=e=>shouldBeRendered(e)?String(e):"";function nodeToFragment(e){const t=new DocumentFragment;return t.append(e),t}const reactivePropertiesFlag=Symbol("reactivePropertiesFlag");function resolveSlotPropIndex(e){return e.startsWith("__internal_")?Number(e.slice(11,-1)):-1}const validNamespaces=["attribute","prop","on","destiny"];function isValidNamespace(e){return validNamespaces.includes(e)}function isValidAttributePair(e){return 2===e.length&&isValidNamespace(e[0])}function parseAttributeName(e){const t=e.split(":");if(1===t.length&&t.unshift("attribute"),!isValidAttributePair(t))throw new Error("Invalid namespace");return t}const propToWatcherMap={value:"input",checked:"change",valueAsDate:"input",valueAsNumber:"input"};function matchChangeWatcher(e){return propToWatcherMap[e]??""}function doOrBind(e,t,a,r){if(a instanceof ReactiveValue1){const s=matchChangeWatcher(t);s&&e.addEventListener(s,(e=>{a.set(e.currentTarget?.[t],{noUpdate:[r]})})),a.bind(r,{dependents:[e]})}else a instanceof ReadonlyReactiveValue1?a.bind(r,{dependents:[e]}):r(a instanceof PassReactiveValue?a.deref:a)}function attribute(e,t){for(const[a,r]of e)doOrBind(t,a,r,(e=>t.setAttribute(a,String(e))))}function destinyUnmount(e,t){deferredElements.set(e,t)}function destinyMount(e,t){if(!(e instanceof Function))throw new TypeError("Value of destiny:mount must be a function");queueMicrotask((()=>queueMicrotask((()=>{e(t)}))))}var _Ref_resolve,_Ref_promise,__classPrivateFieldSet2=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a},__classPrivateFieldGet5=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};class Ref1{constructor(){_Ref_resolve.set(this,void 0),_Ref_promise.set(this,new Promise((e=>{__classPrivateFieldSet2(this,_Ref_resolve,e,"f")})))}set value(e){__classPrivateFieldGet5(this,_Ref_resolve,"f").call(this,e)}then(e){return __classPrivateFieldSet2(this,_Ref_promise,__classPrivateFieldGet5(this,_Ref_promise,"f").then(e),"f"),this}catch(e){return __classPrivateFieldSet2(this,_Ref_promise,__classPrivateFieldGet5(this,_Ref_promise,"f").then(e),"f"),this}finally(e){return __classPrivateFieldGet5(this,_Ref_promise,"f").finally(e),this}}function isObject(e){return!!e&&"object"==typeof e}function destinyRef(e,t){if(!(e instanceof Ref1))throw new TypeError(`Attribute value for destiny:ref must be a Ref, but it was [${isObject(e)?`${e.constructor.name} (Object)`:`${String(e)} (${typeof e})`}] in \n${t.outerHTML}`);queueMicrotask((()=>{e.value=t}))}function prop(e,t){for(const[a,r]of e)doOrBind(t,a,r,(e=>t[a]=e))}function safeStringifyObject(e){try{const t=String(e);return t.startsWith("[")?t:`[object ${e.constructor.name} (${t})]`}catch{return"[unstringifiable object]"}}function describeType(e){return null==e?`[${String(e)}]`:"object"==typeof e?safeStringifyObject(e):`[${typeof e} ${String(e)}]`}function destinyProps(e,t){if("object"!=typeof t||!t)throw new TypeError(`Incorrect attribute value type ${describeType(t)} provided for destiny:props`);prop(new Map(Object.entries(t)),e)}function destiny(e,t){for(const[a,r]of e)switch(a){case"ref":destinyRef(r,t);break;case"mount":destinyMount(r,t);break;case"unmount":destinyUnmount(t,r);break;case"props":destinyProps(t,r);break;default:throw new Error(`Invalid property "destiny:${a}" on element:\n${t.outerHTML}.`)}}function on(e,t){for(const[a,r]of e)Array.isArray(r)?t.addEventListener(a,...r):t.addEventListener(a,r)}function assignElementData(e,t){attribute(t.attribute,e),destiny(t.destiny,e),prop(t.prop,e),on(t.on,e)}_Ref_resolve=new WeakMap,_Ref_promise=new WeakMap;const elementData=new WeakMap;function getElementData1(e){return elementData.get(e)}function hookAttributeSlotsUp(e,t){const a=Object.values(e.querySelectorAll("[destiny\\:attr],[data-capture-props]"));for(const e of a){const{captureProps:a}=e.dataset,r={prop:new Map,on:new Map,destiny:new Map,attribute:new Map};for(const{name:s,value:i}of e.attributes){const e=resolveSlotPropIndex(i);if(-1===e){if(a&&"destiny:attr"!==s){const[e,t]=parseAttributeName(s);r[e].set(t,i)}continue}const n=t[e],[l,o]=parseAttributeName(s);r[l].set(o,n)}a||assignElementData(e,r),elementData.set(e,r)}}class Renderable{}const stronglyHeldDependencies1=new Map,weaklyHeldDependencies1=new IterableWeakMap;var _inner1,_a3,__classPrivateFieldGet6=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};const internalArrays=new(_a3=class{constructor(){_inner1.set(this,new WeakMap)}get(e){return __classPrivateFieldGet6(this,_inner1,"f").get(e)}set(e,t){__classPrivateFieldGet6(this,_inner1,"f").set(e,t)}},_inner1=new WeakMap,_a3);var _inner2,_a4,__classPrivateFieldGet7=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};const splicers=new(_a4=class{constructor(){_inner2.set(this,new WeakMap)}get(e){return __classPrivateFieldGet7(this,_inner2,"f").get(e)}set(e,t){__classPrivateFieldGet7(this,_inner2,"f").set(e,t)}},_inner2=new WeakMap,_a4),processUpdateQueue=(e,t)=>{if(!e.length)return;const a=[];let r=0;for(const t of e)t.show?a.push(t.value):r++;const s=e.find((e=>e.show))?.index??e[0].index+1;t.splice(s,r,...a),e.splice(0,e.length)},updateFilteredArray=(e,t,a,r)=>{let s=-1;const i=[];for(const[n,l]of t.entries()){const o=e(l,n,t);if(o&&s++,o!==(r[n]?.show??throwExpression("Internal error: failed to filter",RangeError))){const e={index:s,show:o,value:l};i.push(e),r[n]=e}else processUpdateQueue(i,a)}processUpdateQueue(i,a)};var _TemplateResult_template,_TemplateResult_props,__classPrivateFieldSet3=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a},__classPrivateFieldSet4=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a},__classPrivateFieldSet5=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a},__classPrivateFieldGet8=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};class TemplateResult extends Renderable{constructor(e,t){super(),_TemplateResult_template.set(this,void 0),_TemplateResult_props.set(this,void 0),__classPrivateFieldSet5(this,_TemplateResult_template,e,"f"),__classPrivateFieldSet5(this,_TemplateResult_props,t,"f")}get content(){const e=__classPrivateFieldGet8(this,_TemplateResult_template,"f").content.cloneNode(!0);return hookSlotsUp(e,__classPrivateFieldGet8(this,_TemplateResult_props,"f")),e}}const specialCaseObjects=[Function,Date,RegExp,DocumentFragment,TemplateResult,Node];function isSpecialCaseObject(e){const t=typeof e;return"function"===t||"object"===t&&specialCaseObjects.some((t=>e instanceof t))}function makeNonPrimitiveItemsReactive(e,t){return e.map((e=>isReactive(e)||!isObject(e)||isSpecialCaseObject(e)?e:reactive1(e,{parent:t})))}function reactive1(e,t={}){if(isReactive(e))return e;const{parent:a}=t;let r;if(isObject(e))if(Array.isArray(e))r=new ReactiveArray1(...e);else if(e instanceof Promise){const a=new ReactiveValue1(t.fallback);e.then((e=>a.value=e)),r=a}else{if(!isSpecialCaseObject(e))return reactiveProperties1(e,t.parent);r=new ReactiveValue1(e)}else r=new ReactiveValue1(e);return a&&r.bind((()=>a.update())),r}function reactiveProperties1(e,t){if(![null,Object].includes(e.constructor))throw new TypeError(`Illegal object ${describeType(e)} passed to \`reactiveProperties()\`. You must either pass in objects that have \`Object\` or \`null\` as their prototype, or wrap the objects using \`ReactiveValue\`.`);const a=Object.fromEntries(Object.entries(e).map((e=>(e[1]=reactive1(e[1],{parent:t}),e))));return a[reactivePropertiesFlag]=!0,Object.freeze(a)}function hookSlotsUp(e,t){hookAttributeSlotsUp(e,t),hookContentSlotsUp(e,t)}var _SlotArray_instances,_SlotArray_startAnchor,_SlotArray_endAnchor,_SlotArray_source,_SlotArray_domArray,_SlotArray_insertToDom,_SlotArray_removeFromDom,__classPrivateFieldGet9=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)},__classPrivateFieldSet6=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a};class SlotArray{constructor(e,t){_SlotArray_instances.add(this),_SlotArray_startAnchor.set(this,new Comment("<DestinyArray>")),_SlotArray_endAnchor.set(this,new Comment("</DestinyArray>")),_SlotArray_source.set(this,void 0),_SlotArray_domArray.set(this,[]),Object.defineProperty(this,"update",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,...a)=>{__classPrivateFieldGet9(this,_SlotArray_instances,"m",_SlotArray_removeFromDom).call(this,e,t),__classPrivateFieldGet9(this,_SlotArray_instances,"m",_SlotArray_insertToDom).call(this,e,...a)}}),e.replaceWith(__classPrivateFieldGet9(this,_SlotArray_startAnchor,"f"),__classPrivateFieldGet9(this,_SlotArray_endAnchor,"f")),__classPrivateFieldSet6(this,_SlotArray_source,t,"f"),__classPrivateFieldGet9(this,_SlotArray_source,"f").bind(this.update,{dependents:[this]})}}function hookContentSlotsUp(e,t){const a=Object.values(e.querySelectorAll("[destiny\\:content]"));for(const e of a){const a=e.getAttribute("destiny:content"),r=t[Number(a)];if(r instanceof ReadonlyReactiveValue1){const t=new Slot(e);r.bind((e=>{t.update(valueToFragment(e))}),{dependents:[t]})}else r instanceof ReadonlyReactiveArray1?new SlotArray(e,r):new Slot(e,valueToFragment(r))}}var _ReadonlyReactiveArray_instances,_ReadonlyReactiveArray___value,_ReadonlyReactiveArray_value_get,_ReadonlyReactiveArray_indices,_ReadonlyReactiveArray_callbacks,_ReadonlyReactiveArray_consumers,_ReadonlyReactiveArray_length,_ReadonlyReactiveArray_nextUpdate,_ReadonlyReactiveArray_argsForFullUpdate,_ReadonlyReactiveArray_splice,_ReadonlyReactiveArray_dispatchUpdateEvents,_ReadonlyReactiveArray_adjustIndices,__classPrivateFieldGet10=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};class ReadonlyReactiveArray1{constructor(...e){_ReadonlyReactiveArray_instances.add(this),_ReadonlyReactiveArray___value.set(this,void 0),_ReadonlyReactiveArray_indices.set(this,void 0),_ReadonlyReactiveArray_callbacks.set(this,new Set),_ReadonlyReactiveArray_consumers.set(this,new IterableWeakMap),_ReadonlyReactiveArray_length.set(this,void 0),__classPrivateFieldSet4(this,_ReadonlyReactiveArray___value,makeNonPrimitiveItemsReactive(e,this),"f"),__classPrivateFieldSet4(this,_ReadonlyReactiveArray_length,computed1((()=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).length)),"f"),__classPrivateFieldSet4(this,_ReadonlyReactiveArray_indices,e.map(((e,t)=>new ReactiveValue1(t))),"f"),splicers.set(this,((...e)=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_splice).call(this,...e))),internalArrays.set(this,__classPrivateFieldGet10(this,_ReadonlyReactiveArray___value,"f"))}toJSON(){return this.value}*[(_ReadonlyReactiveArray___value=new WeakMap,_ReadonlyReactiveArray_indices=new WeakMap,_ReadonlyReactiveArray_callbacks=new WeakMap,_ReadonlyReactiveArray_consumers=new WeakMap,_ReadonlyReactiveArray_length=new WeakMap,_ReadonlyReactiveArray_instances=new WeakSet,_ReadonlyReactiveArray_value_get=function(){if(computedConsumer){const{fn:e,consumer:t}=computedConsumer;t.dependencies.set(this,e),__classPrivateFieldGet10(this,_ReadonlyReactiveArray_consumers,"f").set(t,e)}return __classPrivateFieldGet10(this,_ReadonlyReactiveArray___value,"f")},Symbol.iterator)](){yield*__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get)}async*[Symbol.asyncIterator](){for(;;)yield await __classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_nextUpdate).call(this)}get length(){return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_length,"f")}get value(){return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).slice(0)}set value(e){__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_splice).call(this,0,__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).length,...e)}get(e){const t=e<0?__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).length+e:e;return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get)[t]}set(e,t){return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_splice).call(this,e,1,t),this}pipe(e){const t=new ReadonlyReactiveValue1(e(...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_argsForFullUpdate).call(this))),a=()=>internalSetReactiveValue.get(t)(e(...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_argsForFullUpdate).call(this)));return t.dependencies.set(this,a),__classPrivateFieldGet10(this,_ReadonlyReactiveArray_consumers,"f").set(t,a),t}bind(e,t={}){if(t.noFirstRun||e(0,0,...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get)),t.dependents?.length){const a=new WeakMultiRef(t.dependents);__classPrivateFieldGet10(this,_ReadonlyReactiveArray_consumers,"f").set(a,e),weaklyHeldDependencies1.set(a,this)}else __classPrivateFieldGet10(this,_ReadonlyReactiveArray_callbacks,"f").add(e),stronglyHeldDependencies1.set(e,this);return this}unbind(e){return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_callbacks,"f").delete(e),stronglyHeldDependencies1.delete(e),this}update(){return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_dispatchUpdateEvents).call(this,0,0),this}filter(e,t=[]){const a=new ReactiveArray1,r=[];return t.forEach((t=>{t.bind((()=>updateFilteredArray(e,__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get),a,r)),{noFirstRun:!0,dependents:[a]})})),this.bind(((t,s,...i)=>{0===s&&0===i.length&&updateFilteredArray(e,__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get),a,r);const n=r.slice(0,t).reverse().find((e=>e.show)),l=[];let o=n?.index??-1;const c=s?r.splice(t,s):[];for(const[a,s]of i.entries()){const i=t+a,n=e(s,i,__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get));n&&o++;const c={index:o,show:n};r.splice(i,0,c),n&&l.push(s)}const _=c.filter((e=>e.show)).length;(l.length||_)&&__classPrivateFieldGet10(a,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_splice).call(a,(n?.index??-1)+1,_,...l);const d=l.length-_;if(d)for(let e=t+i.length;e<r.length;e++)r[e].index+=d}),{dependents:[a]}),a.readonly}flat(){const e=new ReactiveArray1(...flatten(__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get)));return this.bind((()=>e.value=flatten(__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get))),{noFirstRun:!1,dependents:[e]}),e.readonly}flatMap(e){const t=()=>flatten(__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).flatMap(e)),a=new ReactiveArray1(...t());return this.bind((()=>a.value=t()),{noFirstRun:!1,dependents:[a]}),a.readonly}map(e){const t=(t,a)=>e(t,__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f")[a]?.readonly??throwExpression("Internal error: lost track of index"),this),a=new ReadonlyReactiveArray1(...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).map(t));return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_callbacks,"f").add(((e,r,...s)=>splicers.get(a)(e,r,...s.map(((a,r)=>t(a,r+e)))))),a}clone(){return new ReactiveArray1(...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get))}slice(e=0,t=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).length-1){const a=new ReactiveArray1(...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).slice(e,t));return this.bind((()=>a.value=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).slice(e,t)),{dependents:[a]}),a.readonly}indexOf(...e){const t=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).indexOf(...e);return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f")[t]?.readonly??new ReadonlyReactiveValue1(-1)}lastIndexOf(...e){const t=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).lastIndexOf(...e);return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f")[t]?.readonly??new ReadonlyReactiveValue1(-1)}join(...e){return this.pipe((()=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).join(...e)))}every(...e){return this.pipe((()=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).every(...e)))}some(...e){return this.pipe((()=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).some(...e)))}exclusiveSome(e){return this.pipe((()=>{const t=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).map(e);return t.includes(!1)&&t.includes(!0)}))}forEach(...e){this.bind(((t,a,...r)=>r.forEach(...e)))}reduce(...e){return this.pipe((()=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).reduce(...e)))}reduceRight(...e){return this.pipe((()=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).reduceRight(...e)))}find(...e){return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).find(...e)}findIndex(...e){const t=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).findIndex(...e);return-1===t?new ReadonlyReactiveValue1(-1):__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f")[t]?.readonly??throwExpression("Internal error: lost track of index")}entries(){const e=new ReactiveArray1(...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).map(((e,t)=>[__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f")[t]?.readonly??throwExpression("Internal error: lost track of index"),e])));return this.bind(((t,a,...r)=>{__classPrivateFieldGet10(e,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_splice).call(e,t,a,...r.map(((e,a)=>[__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f")[t+a]?.readonly??throwExpression("Internal error: lost track of index"),e])))}),{noFirstRun:!0,dependents:[e]}),e.readonly}keys(){const e=new ReactiveArray1(...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f").map((e=>e.readonly)));return this.bind(((t,a,...r)=>{__classPrivateFieldGet10(e,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_splice).call(e,t,a,...r.map(((e,a)=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f")[t+a]?.readonly??throwExpression("Internal error: lost track of index"))))}),{noFirstRun:!0,dependents:[e]}),e.readonly}values(){const e=new ReactiveArray1(...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).values());return this.bind(((t,a,...r)=>{__classPrivateFieldGet10(e,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_splice).call(e,t,a,...r.values())}),{noFirstRun:!0,dependents:[e]}),e.readonly}includes(...e){return this.pipe((()=>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).includes(...e)))}concat(...e){const t=this.clone();this.bind(((...e)=>splicers.get(t)(...e)),{dependents:[t]});const a=[this.length];function r(e,t=0){let r=t;for(let t=0;t<e;t++)r+=a[t]?.value??throwExpression("Internal error: failed to concatenate",RangeError);return r}for(const[s,i]of e.entries())i instanceof ReadonlyReactiveArray1?(i.bind(((e,a,...i)=>t.splice(r(s,e),a,...i)),{dependents:[t]}),a.push(i.length)):i instanceof ReadonlyReactiveValue1?(i.bind((e=>t.splice(r(s),1,e)),{dependents:[t]}),a.push({value:1})):Array.isArray(i)?(t.splice(r(s),0,...i),a.push({value:i.length})):(t.splice(r(s),0,i),a.push({value:1}));return t}}const flatten=e=>e.reduce(((e,t)=>(t instanceof ReadonlyReactiveArray1?e.push(...t.value):e.push(t),e)),[]);function isReactive(e){return[ReadonlyReactiveArray1,ReadonlyReactiveValue1].some((t=>e instanceof t))||!!e&&"object"==typeof e&&reactivePropertiesFlag in e}function valueToFragment(e){return e instanceof TemplateResult?e.content:e instanceof DocumentFragment?e:e instanceof Node?nodeToFragment(e):Array.isArray(e)?arrayToFragment(e):nodeToFragment(new Text(shouldBeRendered(t=e)?String(t):""));var t}function arrayToFragment(e){const t=new DocumentFragment;return t.append(...e.filter(shouldBeRendered).map(valueToFragment)),t}var _ReactiveArray_value,_ReactiveArray_readonly,__classPrivateFieldSet7=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a},__classPrivateFieldGet11=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};class ReactiveArray1 extends ReadonlyReactiveArray1{constructor(...e){super(...e),_ReactiveArray_value.set(this,void 0),_ReactiveArray_readonly.set(this,void 0),__classPrivateFieldSet3(this,_ReactiveArray_value,internalArrays.get(this),"f")}get readonly(){return __classPrivateFieldGet11(this,_ReactiveArray_readonly,"f")??__classPrivateFieldSet3(this,_ReactiveArray_readonly,(()=>{const e=new ReadonlyReactiveArray1;return this.bind(((...t)=>splicers.get(e)(...t)),{dependents:[e]}),e})(),"f")}splice(e,t,...a){return splicers.get(this)(e,t,...a)}copyWithin(e,t=0,a=__classPrivateFieldGet11(this,_ReactiveArray_value,"f").length){const{length:r}=__classPrivateFieldGet11(this,_ReactiveArray_value,"f");e=(e+r)%r,t=(t+r)%r,a=(a+r)%r;const s=Math.min(r-t,a-t);return this.splice(e,s,...__classPrivateFieldGet11(this,_ReactiveArray_value,"f").slice(t,s+t)),this}fill(e,t=0,a=__classPrivateFieldGet11(this,_ReactiveArray_value,"f").length){const r=a-t;return this.splice(t,r,...Array.from({length:r},(()=>e))),this}mutFilter(e){return __classPrivateFieldGet11(this,_ReactiveArray_value,"f").flatMap(((t,a,r)=>e(t,a,r)?[]:a)).reduce(((e,t)=>{const[a]=e;return a&&a[0]+a[1]===t?a[1]++:e.unshift([t,1]),e}),[]).forEach((e=>{this.splice(...e)})),this}mutMap(e){return __classPrivateFieldGet11(this,_ReactiveArray_value,"f").flatMap(((t,a,r)=>{const s=e(t,a,r);return s===t?[]:{index:a,value:s}})).reduce(((e,{index:t,value:a})=>(e.length&&e[0][0]+e[0][1]===t?(e[0][1]++,e[0].push(a)):e.unshift([t,1,a]),e)),[]).forEach((e=>{this.splice(...e)})),this}pop(){return this.splice(-1,1)[0]}push(...e){return this.splice(__classPrivateFieldGet11(this,_ReactiveArray_value,"f").length,0,...e),this.length}reverse(){return this.value=this.value.reverse(),this}shift(){return this.splice(0,1)[0]}sort(e){return this.value=this.value.sort(e),this}unshift(...e){return this.splice(0,0,...e),this.length}}_ReactiveArray_value=new WeakMap,_ReactiveArray_readonly=new WeakMap,_ReadonlyReactiveArray_nextUpdate=function(){return new Promise((e=>{const t=(...a)=>{e(a),__classPrivateFieldGet10(this,_ReadonlyReactiveArray_callbacks,"f").delete(t)};__classPrivateFieldGet10(this,_ReadonlyReactiveArray_callbacks,"f").add(t)}))},_ReadonlyReactiveArray_argsForFullUpdate=function(){return[0,__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).length,...__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get)]},_ReadonlyReactiveArray_splice=function(e,t=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).length-e,...a){if(e>__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).length)throw new RangeError(`Out of bounds assignment: tried to assign to index ${e}, but array length was only ${__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).length}. Sparse arrays are not allowed. Consider using .push() instead.`);__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_adjustIndices).call(this,e,t,a);const r=makeNonPrimitiveItemsReactive(a,this),s=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"a",_ReadonlyReactiveArray_value_get).splice(e,t,...r);return __classPrivateFieldGet10(this,_ReadonlyReactiveArray_instances,"m",_ReadonlyReactiveArray_dispatchUpdateEvents).call(this,e,t,r),s},_ReadonlyReactiveArray_dispatchUpdateEvents=function(e,t,a=[]){const r=concatIterators(__classPrivateFieldGet10(this,_ReadonlyReactiveArray_callbacks,"f").values(),__classPrivateFieldGet10(this,_ReadonlyReactiveArray_consumers,"f").values());for(const s of r)s(e,t,...a)},_ReadonlyReactiveArray_adjustIndices=function(e,t,a){const r=a.length-t;if(r)for(let a=e+t;a<__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f").length;a++)__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f")[a].value+=r;const s=__classPrivateFieldGet10(this,_ReadonlyReactiveArray_indices,"f").splice(e,t,...a.map(((t,a)=>new ReactiveValue1(a+e))));for(const e of s)e.value=-1},_TemplateResult_template=new WeakMap,_TemplateResult_props=new WeakMap;var _Slot_instances,_Slot_id,_Slot_startAnchor,_Slot_endAnchor,_Slot_nodes,_Slot_brandNodes,_Slot_disposeNodes,_Slot_disposeCurrentNodes,__classPrivateFieldGet12=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};let counter=0;class Slot{constructor(e,t){_Slot_instances.add(this),_Slot_id.set(this,counter++),_Slot_startAnchor.set(this,new Comment(`<DestinySlot(${__classPrivateFieldGet12(this,_Slot_id,"f")})>`)),_Slot_endAnchor.set(this,new Comment(`</DestinySlot(${__classPrivateFieldGet12(this,_Slot_id,"f")})>`)),_Slot_nodes.set(this,void 0),__classPrivateFieldSet7(this,_Slot_nodes,[e],"f"),e.replaceWith(__classPrivateFieldGet12(this,_Slot_startAnchor,"f"),e,__classPrivateFieldGet12(this,_Slot_endAnchor,"f")),t&&this.update(t)}replaceItem(e,...t){const a=__classPrivateFieldGet12(this,_Slot_nodes,"f").indexOf(e);if(a<0)throw new Error("Can't replace an item that isn't here.");const r=t.flatMap((e=>"string"==typeof e?new Text(e):e instanceof DocumentFragment?[...e.childNodes]:e));__classPrivateFieldGet12(this,_Slot_instances,"m",_Slot_brandNodes).call(this,r),e.before(...r),__classPrivateFieldGet12(this,_Slot_instances,"m",_Slot_disposeNodes).call(this,[e]),__classPrivateFieldGet12(this,_Slot_nodes,"f").splice(a,1,...r)}update(e){const t=e instanceof TemplateResult?e.content:e;__classPrivateFieldGet12(this,_Slot_instances,"m",_Slot_disposeCurrentNodes).call(this),__classPrivateFieldSet7(this,_Slot_nodes,Object.values(t.childNodes),"f"),__classPrivateFieldGet12(this,_Slot_instances,"m",_Slot_brandNodes).call(this,__classPrivateFieldGet12(this,_Slot_nodes,"f")),__classPrivateFieldGet12(this,_Slot_endAnchor,"f").before(t)}async remove(){await __classPrivateFieldGet12(this,_Slot_instances,"m",_Slot_disposeCurrentNodes).call(this),__classPrivateFieldGet12(this,_Slot_startAnchor,"f").remove(),__classPrivateFieldGet12(this,_Slot_endAnchor,"f").remove()}insertBeforeThis(...e){__classPrivateFieldGet12(this,_Slot_startAnchor,"f").before(...e)}}function isRenderable(e){return Boolean(e)&&e instanceof Renderable}_Slot_id=new WeakMap,_Slot_startAnchor=new WeakMap,_Slot_endAnchor=new WeakMap,_Slot_nodes=new WeakMap,_Slot_instances=new WeakSet,_Slot_brandNodes=function(e){e.forEach((e=>e.destinySlot=this))},_Slot_disposeNodes=async function(e){await Promise.all(e.map((e=>deferredElements.get(e)?.(e))));for(const t of e)t.remove()},_Slot_disposeCurrentNodes=async function(){await __classPrivateFieldGet12(this,_Slot_instances,"m",_Slot_disposeNodes).call(this,__classPrivateFieldGet12(this,_Slot_nodes,"f").splice(0,__classPrivateFieldGet12(this,_Slot_nodes,"f").length))},_SlotArray_startAnchor=new WeakMap,_SlotArray_endAnchor=new WeakMap,_SlotArray_source=new WeakMap,_SlotArray_domArray=new WeakMap,_SlotArray_instances=new WeakSet,_SlotArray_insertToDom=function(e,...t){t.forEach(((t,a)=>{const r=a+e,s=new Comment("Destiny slot placeholder");if(!__classPrivateFieldGet9(this,_SlotArray_domArray,"f").length||r>__classPrivateFieldGet9(this,_SlotArray_domArray,"f").length-1)__classPrivateFieldGet9(this,_SlotArray_endAnchor,"f").before(s);else{const e=__classPrivateFieldGet9(this,_SlotArray_domArray,"f")[r];e||throwExpression(`Tried to insert to DOM at an invalid position ${r} at an array of length ${__classPrivateFieldGet9(this,_SlotArray_domArray,"f").length}`,RangeError),e.insertBeforeThis(s)}__classPrivateFieldGet9(this,_SlotArray_domArray,"f").splice(r,0,new Slot(s,t))}))},_SlotArray_removeFromDom=function(e,t){const a=Math.min(e+t,__classPrivateFieldGet9(this,_SlotArray_domArray,"f").length);for(let t=e;t<a;t++)__classPrivateFieldGet9(this,_SlotArray_domArray,"f")[t]?.remove();__classPrivateFieldGet9(this,_SlotArray_domArray,"f").splice(e,t)};class TemplateCache extends WeakMap{computeIfAbsent(e,t,a){const r=this.get(e);if(r){for(const[e,s]of r[1])if(a[e]!==s)return t()[0];return r[0]}{const a=t();return this.set(e,a),a[0]}}}function resolveSlots(e){const t=document.createTreeWalker(e.content,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT),a=[];for(;t.nextNode();){const e=t.currentNode;if(isTextNode(e)){const t=e.wholeText.matchAll(/"__internal_([0-9]+)_"/gu),r={node:e,slots:[...t].map((e=>({index:Number(e[1]),start:e.index,end:e.index+e[0].length})))};r.slots.length&&a.push(r)}else if(isElement(e))for(const{value:t}of e.attributes)t.includes("__internal_")&&e.setAttribute("destiny:attr","")}prepareContentSlots(a)}const namespaces='xmlns="http://www.w3.org/1999/xhtml" xmlns:on="p:u" xmlns:prop="p:u" xmlns:destiny="p:u"';function arrayWrap(e){return Array.isArray(e)?e:[e]}const supportsAdoptedStyleSheets="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype;function attachCSSProperties1(e,t){for(const[a,r]of Object.entries(t))r.bind((t=>e.style.setProperty(a,t)),{dependents:[e]})}const pseudoRandomId=pseudoRandomIdGenerator();function componentOrComponentModule(e){if(isComponent(e))return e;if("object"!=typeof e||!e)throw new TypeError(`Invalid type ${describeType(e)} supplied for prop:for`);const t=e.default;if(!isComponent(t))throw new TypeError(`Invalid component constructor ${describeType(t)} supplied for asynchronously loaded element. Expected type is a Promise that resolves to a Component or to a module with a Component as the default export.`);return t}const templateCache=new TemplateCache;function isComponent(e){return Boolean(e)&&"function"==typeof e&&Object.prototype.isPrototypeOf.call(Component1,e)}const xmlDocument=(new DOMParser).parseFromString(`<xml ${namespaces} />`,"application/xhtml+xml"),xmlRange=xmlDocument.createRange(),xmlRoot=xmlDocument.querySelector("xml");xmlRange.setStart(xmlRoot,0),xmlRange.setEnd(xmlRoot,0);let notSafari=!0;function parseString(e){const t=document.createElement("template");if(notSafari)try{t.content.append(xmlRange.createContextualFragment(e))}catch(a){const{message:r}=a;if("The string did not match the expected pattern."!==r)throw new SyntaxError(`${r}\nat\n${e}\nwhich resulted in the following message:\n${getXmlErrorMessage(parseAsNewDocument(e.replace(/^\n/,"")))}`);notSafari=!1,parseInSafari(t,e)}else parseInSafari(t,e);return t}function createTemplate([e,...t],a){let r=e;const s=new Map;for(const[e,i]of t.entries()){const t=a[e];r.endsWith("<")?(s.set(e,t),isComponent(t)&&t.captureProps?r+=`${t.register()} data-capture-props="true"${i}`:r+=t instanceof Promise?`${DestinyFallback.register()} prop:for="__internal_${e}_" data-capture-props="true"${i}`:String(t)+i):r.endsWith("</")?(s.set(e,t),r+=t instanceof Promise?DestinyFallback.register()+i:String(t)+i):r+=`"__internal_${e}_"${i}`}const i=parseString(r);return resolveSlots(i),[i,s]}const registeredComponents=new Map;function register1(e,t=!0){const a=registeredComponents.get(e);if(a)return a;const r=e.name,s=`${r?pascalToKebab(r):"anonymous"}${t?"":`-${pseudoRandomId.next().value}`}`;return customElements.define(s,e),registeredComponents.set(e,s),s}class ComponentImplementation extends HTMLElement{constructor(){if(super(),Object.defineProperty(this,"forwardProps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:xml1`<slot />`}),new.target===ComponentImplementation)throw new TypeError("Can't initialize abstract class.");const e=getElementData1(this);e&&this.forwardProps&&this.forwardProps.then((t=>{elementData.set(t,e),assignElementData(t,e)}));const t=this.attachShadow({mode:"open"});queueMicrotask((()=>{if(e)for(const[t,a]of e.prop){let e,r=this.constructor.prototype;for(;!e&&r&&r!==HTMLElement;)e=Object.getOwnPropertyDescriptor(r,t),r=Object.getPrototypeOf(r);e?.set&&(delete this[t],this[t]=a)}t.appendChild(isReactive(this.template)?xml1`${this.template}`.content:this.template.content),supportsAdoptedStyleSheets?t.adoptedStyleSheets=arrayWrap(new.target.styles).map((e=>e.styleSheet)):t.append(...arrayWrap(new.target.styles).map((e=>e.styleElement)))}))}attachCSSProperties(e){attachCSSProperties1(this,e)}replaceWith(...e){this.destinySlot?this.destinySlot.replaceItem(this,...e):super.replaceWith(...e)}unmount(e){return deferredElements.set(this,e),this}static register(){return register1(this,!1)}static get tagName(){return this.register()}static[Symbol.toPrimitive](){return this.tagName}}var __classPrivateFieldGet13=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)};function xml1(e,...t){const a=templateCache.computeIfAbsent(e,(()=>createTemplate(e,t)),t);return new TemplateResult(a,t)}Object.defineProperty(ComponentImplementation,"captureProps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(ComponentImplementation,"styles",{enumerable:!0,configurable:!0,writable:!0,value:[]});const Component1=ComponentImplementation;var _DestinyFallback_view;class DestinyFallback extends Component1{constructor(){super(),Object.defineProperty(this,"forwardProps",{enumerable:!0,configurable:!0,writable:!0,value:new Ref1}),_DestinyFallback_view.set(this,new ReactiveValue1(xml1``)),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:__classPrivateFieldGet13(this,_DestinyFallback_view,"f")}),queueMicrotask((async()=>{const e=getElementData1(this).prop,t=e.get("fallback");if(t){if(!isRenderable(t))throw new TypeError(`Incorect type ${describeType(t)} for prop:fallback: Renderable expected`);__classPrivateFieldGet13(this,_DestinyFallback_view,"f").value=t}try{const t=componentOrComponentModule(await e.get("for"));__classPrivateFieldGet13(this,_DestinyFallback_view,"f").value=xml1`
          <${t}
            destiny:ref=${this.forwardProps}
            destiny:mount=${e=>e.append(...this.childNodes)}
          />
        `}catch(t){const a=e.get("catch");if(!a)throw t;{if("function"!=typeof a)throw new TypeError(`Uncallable type ${describeType(a)} provided for prop:error as the exception handler. Expected type is (error: Error) => Renderable.`);const e=a(t);if(!isRenderable(e))throw new TypeError(`Exception handler for prop:error retrned ${describeType(e)}, but Renderable was expected.`);__classPrivateFieldGet13(this,_DestinyFallback_view,"f").value=e}}}))}}function classNames1(e){return computed1((()=>Object.entries(e).filter((([,e])=>e instanceof ReadonlyReactiveValue1?e.value:e)).map((([e])=>e)).join(" ")))}_DestinyFallback_view=new WeakMap,Object.defineProperty(DestinyFallback,"captureProps",{enumerable:!0,configurable:!0,writable:!0,value:!0});var _CSSTemplate_stylesheet,__classPrivateFieldGet14=this&&this.__classPrivateFieldGet||function(e,t,a,r){if("a"===a&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?r:"a"===a?r.call(e):r?r.value:t.get(e)},__classPrivateFieldSet8=this&&this.__classPrivateFieldSet||function(e,t,a,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,a):s?s.value=a:t.set(e,a),a};class CSSTemplate1{constructor(e){Object.defineProperty(this,"cssText",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),_CSSTemplate_stylesheet.set(this,void 0),this.cssText=e}get styleElement(){return Object.assign(document.createElement("style"),{textContent:this.cssText})}get styleSheet(){return __classPrivateFieldGet14(this,_CSSTemplate_stylesheet,"f")||(__classPrivateFieldSet8(this,_CSSTemplate_stylesheet,new CSSStyleSheet,"f"),__classPrivateFieldGet14(this,_CSSTemplate_stylesheet,"f").replace(this.cssText)),__classPrivateFieldGet14(this,_CSSTemplate_stylesheet,"f")}}_CSSTemplate_stylesheet=new WeakMap;export{ReactiveValue1 as ReactiveValue,ReadonlyReactiveValue1 as ReadonlyReactiveValue,ReactiveArray1 as ReactiveArray,ReadonlyReactiveArray1 as ReadonlyReactiveArray,reactiveProperties1 as reactiveProperties,reactive1 as reactive,computed1 as computed,xml1 as xml,xml1 as html,xml1 as css,Component1 as Component,getElementData1 as getElementData,register1 as register,Ref1 as Ref,classNames1 as classNames,CSSTemplate1 as CSSTemplate,attachCSSProperties1 as attachCSSProperties,assignElementData,SlotArray};function getXmlErrorMessage(e){return e?.firstElementChild?.textContent??"unknown error"}function parseAsNewDocument(e){return(new DOMParser).parseFromString(`<xml ${namespaces}>${e}</xml>`,"application/xml")}function parseInSafari(e,t){const a=parseAsNewDocument(t).firstElementChild;if("parsererror"===a?.firstElementChild?.nodeName.toLowerCase())throw new SyntaxError(`An error occurred when parsing the following XML:\n${t}\nwhich resulted in the following message:\n${getXmlErrorMessage(a)}`);e.content.append(...a?.childNodes??[])}function isTextNode(e){return e.nodeType===Node.TEXT_NODE}function isElement(e){return e.nodeType===Node.ELEMENT_NODE}function createPlaceholder(e){const t=document.createElement("template");return t.setAttribute("destiny:content",String(e)),t}function prepareContentSlots(e){e.forEach((e=>{const t=e.node.textContent??"",a=e.slots.flatMap(((e,a,r)=>[new Text(t.slice(r[a-1]?.end??0,e.start)),createPlaceholder(e.index)]));e.node.replaceWith(...a,new Text(t.slice(e.slots.pop()?.end)))}))}const pseudoRandomEncode=(e,t)=>a=>a*t%e,idEncoder=pseudoRandomEncode(2n**20n,387420489n);function*pseudoRandomIdGenerator(){let e=0n;for(;;)yield idEncoder(++e).toString(36)}function pascalToKebab(e){return`${e[0]??""}${e.slice(1).replace(/([A-Z])/g,"-$1")}`.toLowerCase()}
